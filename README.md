# deepseekMine 检索与生成性能测试说明

本说明文档系统整理了 deepseekMine 检索与生成能力完整测试报告中的所有核心表格数据，涵盖逐步上传与一次性上传两种模式下的详细评测结果，便于横向对比与快速查阅。

## 环境准备

- **Python 版本**：建议 Python 3.10 及以上
- **依赖安装**：

```bash
pip install -r requirements.txt
```


## 检索测试操作说明

### 逐步上传模式

- **测试脚本**：`rag_retrieval_eval.py`
- **主要参数**：
    - `--dataset`：数据集名称（`zh_int` 或 `zh_refine`）
    - `--noise_rate`：噪声比率（如 0.0、0.2、0.4、0.6、0.8）
    - `--num`：每组测试数量
- **示例代码**：

```python
import os

noise_rates = [0.0, 0.2, 0.4, 0.6, 0.8]
for rate in noise_rates:
    cmd = f"python rag_retrieval_eval.py --dataset zh_int --noise_rate {rate} --num 5"
    os.system(cmd)
```

> 将 `zh_int` 替换为 `zh_refine` 以测试不同数据集。


### 一次性上传模式

- **测试命令**：

```bash
python rag_retrieval_eval.py --dataset zh_refine --all_in_one_upload
python rag_retrieval_eval.py --dataset zh_int --all_in_one_upload
```


## 生成性能测试操作说明

### 逐步上传模式

- **测试脚本**：
    - `test_deepseek.py`
    - `test_Qwen3.py`
- **操作**：分别运行上述脚本，测试不同模型的生成性能。


### 一次性上传模式

- **准备数据**：
    - `merged_all_docs.txt1`（对应 `zh_refine`）
    - `merged_all_docs.txt2`（对应 `zh_int`）
- **运行脚本**：

```bash
python auto.py
```


## 常见问题与建议

- 若遇到依赖包缺失，请根据错误提示补充安装。
- 建议在虚拟环境下运行，避免依赖冲突。
- **必须在 deepseekMine 服务运行的同时进行测试。**


## 检索能力评测

### 1. 逐步上传模式（逐轮注入文档）

#### zh_refine 数据集（鲁棒性测试）

| 噪声率 | Precision@5 (均值±标准差) | Recall@5 (均值±标准差) | MRR (均值±标准差) | NDCG (均值±标准差) |
| :--: | :-- | :-- | :-- | :-- |
| 0.0 | 0.9400 ± 0.0566 | 0.6293 ± 0.0642 | 0.9400 ± 0.0566 | 0.7186 ± 0.0568 |
| 0.2 | 0.9179 ± 0.0619 | 0.7258 ± 0.0874 | 0.9217 ± 0.0649 | 0.7751 ± 0.0730 |
| 0.4 | 0.8873 ± 0.0685 | 0.8156 ± 0.0855 | 0.8956 ± 0.0756 | 0.8259 ± 0.0747 |
| 0.6 | 0.7768 ± 0.0868 | 0.8767 ± 0.0834 | 0.8444 ± 0.0943 | 0.8520 ± 0.0824 |
| 0.8 | 0.5804 ± 0.1171 | 0.8700 ± 0.1135 | 0.6965 ± 0.1428 | 0.8028 ± 0.1223 |

#### zh_int 数据集（信息整合能力测试）

| 噪声率 | Precision@5 (均值±标准差) | Recall@5 (均值±标准差) | MRR (均值±标准差) | NDCG (均值±标准差) |
| :--: | :-- | :-- | :-- | :-- |
| 0.0 | 0.9775 ± 0.0203 | 0.8690 ± 0.0627 | 0.9800 ± 0.0198 | 0.8945 ± 0.0452 |
| 0.2 | 0.9555 ± 0.0299 | 0.8017 ± 0.0676 | 0.9683 ± 0.0262 | 0.8379 ± 0.0505 |
| 0.4 | 0.8983 ± 0.0482 | 0.8133 ± 0.0742 | 0.9300 ± 0.0456 | 0.8376 ± 0.0588 |
| 0.6 | 0.8098 ± 0.0859 | 0.8000 ± 0.0960 | 0.8467 ± 0.0913 | 0.7852 ± 0.0857 |
| 0.8 | 0.8115 ± 0.0914 | 0.9300 ± 0.0658 | 0.8450 ± 0.0927 | 0.9009 ± 0.0728 |

### 2. 一次性上传模式（全量注入文档）

| 数据集 | 精确率(均值±标准差) | 召回率(均值±标准差) | 平均倒数排名(均值±标准差) | NDCG (均值±标准差) |
| :-- | :-- | :-- | :-- | :-- |
| zh_refine | 0.5338 (±0.1167) | 0.3209 (±0.0497) | 0.6903 (±0.1561) | 0.5442 (±0.1216) |
| zh_int | 0.4020 (±0.1139) | 0.1334 (±0.0177) | 0.5428 (±0.1695) | 0.4033 (±0.1158) |

### 3. 数据集统计信息

| 数据集名称 | 总字符数 | 正样本比例 | 负样本比例 |
| :-- | :-- | :-- | :-- |
| zh_refine | 1,470,972 | 31.53% (463,825) | 68.47% (1,007,147) |
| zh_int | 1,167,197 | 25.49% (297,465) | 74.51% (869,732) |

## 生成能力评测

### 1. 逐步上传模式下不同模型与噪声率

| 模型名 | 噪声值0.0 | 噪声值0.2 | 噪声值0.4 | 噪声值0.6 | 噪声值0.8 | 噪声值1.0 | 信息整合能力 |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| deepseek-r1:1.5b | 98.08% (±0.83) | 95.67% (±0.39) | 95.17% (±1.00) | 89.75% (±1.72) | 64.75% (±0.60) | 2.25% (±0.74) | 60.00% (±3.56) |
| deepseek-r1:7b | 98.67% (±0.27) | 97.83% (±0.33) | 96.92% (±1.52) | 95.67% (±0.28) | 82.00% (±0.97) | 4.42% (±0.91) | 72.50% (±3.32) |
| deepseek-r1:8b | 99.17% (±0.15) | 98.42% (±0.62) | 97.75% (±0.15) | 97.17% (±0.67) | 86.42% (±1.59) | 5.92% (±0.61) | 76.25% (±2.22) |
| Qwen3:0.6B | 98.58% (±0.32) | 98.25% (±0.99) | 96.34% (±0.77) | 94.92% (±1.77) | 76.50% (±1.35) | 3.25% (±1.29) | 60.75% (±3.69) |
| Qwen3:1.7B | 99.33% (±0.00) | 99.50% (±0.20) | 98.58% (±0.32) | 98.50% (±0.43) | 90.25% (±1.37) | 8.84% (±0.19) | 78.44% (±1.38) |
| Qwen3:4B | 99.25% (±0.16) | 98.92% (±0.16) | 98.83% (±0.34) | 98.25% (±0.50) | 92.25% (±0.50) | 17.92% (±2.42) | 81.73% (±7.43) |
| Qwen3:8B | 99.17% (±0.33) | 98.33% (±0.91) | 97.92% (±0.74) | 97.24% (±1.35) | 91.15% (±2.66) | 23.96% (±2.04) | 80.60% (±6.19) |

### 2. 一次性上传模式下不同模型准确率

| 模型 | zh_refine 准确率 | zh_int 准确率 |
| :-- | :-- | :-- |
| deepseek-r1-1.5B | 77.00% ± 4.23% | 24.50% ± 2.08% |
| deepseek-r1-7B | 82.42% ± 3.26% | 29.75% ± 1.50% |
| deepseek-r1-8B | 83.33% ± 3.84% | 34.75% ± 1.71% |
| qwen3-0.6B | 80.42% ± 4.43% | 25.50% ± 2.99% |
| qwen3-1.7B | 84.83% ± 3.38% | 37.09% ± 1.66% |
| qwen3-4B | 87.35% ± 4.14% | 47.36% ± 2.89% |
| qwen3-8B | 87.43% ± 3.25% | 48.25% ± 1.23% |

## 检索指标解读

| 指标 | 定义 | 意义 |
| :-- | :-- | :-- |
| Precision@5 | 前5条检索结果中相关文档数/5 | 衡量最前面结果的相关性，代表命中率和用户体验友好度 |
| Recall@5 | 前5条检索结果中相关文档数/所有相关文档总数 | 反映系统对所有相关信息的覆盖能力 |
| MRR | 第一个相关文档排名的倒数，对所有查询取平均 | 强调首个相关文档出现的位置 |
| NDCG | 综合考虑相关文档数量和排序，对排名靠前的相关文档给予更高权重 | 反映整体排序合理性 |


```

如有疑问，请联系我






